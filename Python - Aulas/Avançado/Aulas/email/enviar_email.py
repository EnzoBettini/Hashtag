import smtplib
import email.message
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart
from email.mime.application import MIMEApplication
from dotenv import load_dotenv
import os

def enviar_email():
    load_dotenv()
    EMAIL_SENDER = os.getenv("EMAIL_SENDER")
    EMAIL_CC = os.getenv("EMAIL_CC")
    EMAIL_PASSWORD = os.getenv("EMAIL_PASSWORD")

    msg = MIMEMultipart()
    msg["Subject"] = 'Email com Python'
    msg["From"] = EMAIL_SENDER
    msg["To"] = EMAIL_SENDER
    msg["Cc"] = EMAIL_CC
    msg["Bcc"] = ''

    corpo_email = """
    <b>Boa Tarde</b>
    <p>Este é um e-mail automatizado</p>
    <img src="data:image/jpeg;base64,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">
    """

    msg.attach(MIMEText(corpo_email, 'html'))

    with open(fr'C:\Users\enzo.bettini\Documents\Hashtag\Python - Aulas\Avançado\email\Attach.pdf', 'rb') as arquivo:
        msg.attach(MIMEApplication(arquivo.read(), Name='Attach.pdf'))

    servidor = smtplib.SMTP("smtp.gmail.com", 587)
    servidor.starttls()
    servidor.login(msg["From"], EMAIL_PASSWORD)
    servidor.send_message(msg)
    servidor.quit()
    print('Email Enviado!')



enviar_email()
